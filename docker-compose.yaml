services:
  client:
    build:
      context: ./client
      dockerfile: Dockerfile
    ports:
      - 3000:3000
    environment:
      - TAWAKTO_PROPERTY_ID=663e222a07f59932ab3e35cc
      - TAWAKTO_WIDGET_ID=1hthbaum8
      - AUTH_SECRET=xMkJaZKzK36EM6W19uqt6WUUnu1+4S3hmYO5GpvQpXvq
      - NEXTAUTH_URL=http://localhost:3000
      - JWT_SECRET=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
      - GITHUB_CLIENT_ID=bd0de2702eda44b09af3
      - GITHUB_CLIENT_SECRET=58229307d67f3d8bd9f77c61b4c74179d5c2566b
      - GOOGLE_CLIENT_ID=894245936221-vt9kgb6lsef56d2r5u1ctkq823fmf649.apps.googleusercontent.com
      - GOOGLE_CLIENT_SECRET=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
      - EMAIL_USER=info.alamgirhussain@gmail.com
      - EMAIL_PASS=bmtkyzhpcdhrhbuq
      - ADMIN_MAILS=info.alamgirhussain@gmail.com,wafipix1@gmail.com
    depends_on:
      - server
    develop:
      watch: 
        - action: rebuild
          path: ./client/package.json

        - action: sync
          path: ./client/
          target: /app

    networks:
      - wafipix_network
  
  server:
    build:
      context: ./server
      dockerfile: Dockerfile
    ports:
      - 3001:3001
    environment:
      - PORT=3001
      - MONGODB_URL=mongodb+srv://wafipix:wafipix82@wafipix.8l5wqwk.mongodb.net/wafipixv2?retryWrites=true&w=majority&appName=wafipixv2
      # - MONGODB_URL=mongodb://host.docker.internal:27017/wafipix
      - CLOUDINARY_CLOUD_NAME=dugc533jq
      - CLOUDINARY_API_KEY=911967824621894
      - CLOUDINARY_API_SECRET=EBzOzyWl2UfNguHh9CGqxfC4U2k
      - CLOUDINARY_PORTFOLIO_PROFILE_IMAGE_FOLDER=wafipix/portfolio/images/profile
      - CLOUDINARY_PORTFOLIO_MEDIA_IMAGE_FOLDER=wafipix/portfolio/images/media
      - CLOUDINARY_PORTFOLIO_MEDIA_VIDEO_FOLDER=wafipix/portfolio/videos/media
      - JWT_SECRET=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
      - EMAIL_USER=info.alamgirhussain@gmail.com
      - EMAIL_PASS=cbyl fmrs lifc agbt
      - CONTACT_MAIL=info.alamgirhussain@gmail.com
    develop:
      watch: 
        - action: rebuild
          path: ./server/package.json

        - action: sync
          path: ./server/src
          target: /app
    
    networks:
      - wafipix_network

networks:
  wafipix_network:
    driver: bridge

  

